1:"$Sreact.fragment"
2:I[47395,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"default"]
3:I[52296,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js","/_next/static/chunks/7f3c6470804733fc.js","/_next/static/chunks/1004c0a689e16f66.js"],"default"]
4:I[26446,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"Image"]
5:I[98951,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"default"]
6:I[20588,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"default"]
7:I[35910,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"default"]
8:I[78142,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"default"]
9:I[84240,["/_next/static/chunks/d12f64cde7c47586.js","/_next/static/chunks/2cc7ed3dfa1b294e.js"],"default"]
a:I[19320,["/_next/static/chunks/d12f64cde7c47586.js","/_next/static/chunks/2cc7ed3dfa1b294e.js"],"default"]
11:I[28011,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"default"]
:HL["/_next/static/chunks/f7abb55908231aa2.css","style"]
:HL["/_next/static/chunks/83629eefef34b003.css","style"]
:HL["/_next/static/media/feb57b2dc8f29018-s.p.fc277c93.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
b:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z0:{"P":null,"b":"zdm6_EHzdMl2rCxK6ehlW","p":"","c":["","blog","react-native"],"i":false,"f":[[["",{"children":["blog",{"children":[["pid","react-native","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/f7abb55908231aa2.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/chunks/83629eefef34b003.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","script","script-0",{"src":"/_next/static/chunks/b9ccaea0d93f976a.js","async":true,"nonce":"$undefined"}],["$","script","script-1",{"src":"/_next/static/chunks/75fe57ca492bcc5c.js","async":true,"nonce":"$undefined"}]],["$","html",null,{"lang":"zh-CN","className":"transition-colors duration-1000 noto_sans_sc_42b2425e-module__9CUXnq__className","children":["$","body",null,{"className":"flex flex-col items-center min-h-dvh","children":[["$","$L2",null,{"className":"fixed top-0 left-0 right-0 bottom-0 -z-10"}],["$","header",null,{"className":"navbar shadow-sm bg-base-200/60 backdrop-blur fixed z-10","children":[["$","div",null,{"className":"navbar-start","children":["$","$L3",null,{"href":"/","className":"text-xl font-bold hover:text-sky-600 flex gap-1 items-center px-2","children":[["$","$L4",null,{"src":{"src":"/_next/static/media/icon.7d834061.svg","width":192,"height":192,"blurWidth":0,"blurHeight":0},"alt":"王郁的小站","width":32,"height":32}],["$","span",null,{"className":"bg-gradient-to-br dark:bg-gradient-to-tr from-sky-600 to-pink-600 dark:from-pink-400 dark:to-sky-400 bg-clip-text text-transparent","children":"王郁的小站"}]]}]}],["$","nav",null,{"className":"navbar-center hidden lg:flex","children":["$","$L5",null,{}]}],["$","div",null,{"className":"navbar-end gap-2","children":[["$","$L6",null,{}],["$","$L7",null,{}],["$","$L8",null,{}]]}]]}],["$","main",null,{"className":"flex-1 pt-16 flex flex-col lg:flex-row gap-4 w-full overflow-auto","children":["$","$L9",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$La",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}],["$","footer",null,{"className":"w-full h-10 shadow-sm bg-base-200/60 backdrop-blur bottom-0 right-0 left-0 flex flex-col md:flex-row justify-center items-center py-2 border-t border-slate-400/30 text-xs md:text-sm","children":[["$","a",null,{"href":"https://beian.miit.gov.cn","target":"_blank","className":"md:mr-2 md:pr-2 md:border-r border-base-content hover:text-info transition-colors","children":"陕ICP备15011477号"}],["$","div",null,{"className":"flex items-center","children":[["$","p",null,{"children":"2015-2025 ©wycode.cn All Right Reserved"}],["$","a",null,{"href":"https://github.com/wangyucode/wycode-next","target":"_blank","className":"ml-2 pl-2 border-l border-base-content hover:text-info transition-colors","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","stroke":"currentColor","fill":"currentColor","viewBox":"0 0 496 512","className":"mr-2 h-4 w-4","children":["$","path",null,{"d":"$b"}]}]}]]}]]}],"$Lc"]}]}]]}],{"children":["blog","$Ld",{"children":[["pid","react-native","d"],"$Le",{"children":["__PAGE__","$Lf",{},null,false]},null,false]},null,false]},null,false],"$L10",false]],"m":"$undefined","G":["$11",["$L12","$L13"]],"s":false,"S":true}
14:I[97287,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js"],"default"]
16:I[84652,["/_next/static/chunks/d12f64cde7c47586.js","/_next/static/chunks/2cc7ed3dfa1b294e.js"],"OutletBoundary"]
18:I[83670,["/_next/static/chunks/d12f64cde7c47586.js","/_next/static/chunks/2cc7ed3dfa1b294e.js"],"AsyncMetadataOutlet"]
1a:I[84652,["/_next/static/chunks/d12f64cde7c47586.js","/_next/static/chunks/2cc7ed3dfa1b294e.js"],"ViewportBoundary"]
1c:I[84652,["/_next/static/chunks/d12f64cde7c47586.js","/_next/static/chunks/2cc7ed3dfa1b294e.js"],"MetadataBoundary"]
1d:"$Sreact.suspense"
c:["$","$L14",null,{}]
d:["$","$1","c",{"children":[null,["$","$L9",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$La",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}]
e:["$","$1","c",{"children":[null,["$","$L9",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$La",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}]
f:["$","$1","c",{"children":["$L15",[["$","script","script-0",{"src":"/_next/static/chunks/7f3c6470804733fc.js","async":true,"nonce":"$undefined"}],["$","script","script-1",{"src":"/_next/static/chunks/1004c0a689e16f66.js","async":true,"nonce":"$undefined"}]],["$","$L16",null,{"children":["$L17",["$","$L18",null,{"promise":"$@19"}]]}]]}]
10:["$","$1","h",{"children":[null,[["$","$L1a",null,{"children":"$L1b"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$L1c",null,{"children":["$","div",null,{"hidden":true,"children":["$","$1d",null,{"fallback":null,"children":"$L1e"}]}]}]]}]
12:["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/f7abb55908231aa2.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]
13:["$","link","1",{"rel":"stylesheet","href":"/_next/static/chunks/83629eefef34b003.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]
15:["$","div",null,{"className":"container mx-auto w-full p-4","children":[["$","article",null,{"className":"card shadow bg-base-100 p-4 mb-4","children":[["$","h1",null,{"className":"text-2xl text-slate-800 dark:text-slate-200 font-extrabold text-center","children":"React Native源码解析（Android篇）"}],["$","div",null,{"className":"flex justify-between text-sm mb-4 flex-wrap gap-2","children":[["$","span",null,{"className":"flex items-center","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","ref":"$undefined","aria-labelledby":"$undefined","className":"inline mr-1 h-5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}]]}],"2018-03-19"]}],["$","$L3",null,{"href":"/blog/category/frontend","className":"flex items-center px-3 py-1 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-sm rounded-full","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","ref":"$undefined","aria-labelledby":"$undefined","className":"inline mr-1 h-4 mb-0.5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}]]}],"Frontend"]}]]}],["$","div",null,{"className":"flex items-center gap-2 mb-4","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","ref":"$undefined","aria-labelledby":"$undefined","className":"inline h-5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}],["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M6 6h.008v.008H6V6Z"}]]}],["$","div",null,{"className":"flex flex-wrap gap-1","children":[["$","$L3","Android",{"href":"/blog/tag/android","className":"px-2 bg-green-50 hover:bg-green-100 dark:bg-green-900/30 dark:hover:bg-green-900/50 text-sm rounded-full","children":"Android"}],["$","$L3","React Native",{"href":"/blog/tag/react-native","className":"px-2 bg-cyan-50 hover:bg-cyan-100 dark:bg-cyan-900/30 dark:hover:bg-cyan-900/50 text-sm rounded-full","children":"React Native"}],["$","$L3","React",{"href":"/blog/tag/react","className":"px-2 bg-indigo-50 hover:bg-indigo-100 dark:bg-indigo-900/30 dark:hover:bg-indigo-900/50 text-sm rounded-full","children":"React"}],["$","$L3","iOS",{"href":"/blog/tag/ios","className":"px-2 bg-pink-50 hover:bg-pink-100 dark:bg-pink-900/30 dark:hover:bg-pink-900/50 text-sm rounded-full","children":"iOS"}]]}]]}],["$","div",null,{"className":"mt-4","children":["$","div",null,{"className":"prose max-w-full","children":[["$","figure","img-0",{"className":"flex flex-col items-center","children":[["$","img",null,{"src":"/images/20180213_react.png","alt":"React","node":{"type":"element","tagName":"img","properties":{"src":"/images/20180213_react.png","alt":"React"},"children":[],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":37,"offset":37}}},"className":"mx-auto max-h-64 max-w-72"}],["$","figcaption",null,{"className":"text-sm text-gray-500 dark:text-gray-400 mt-1","children":"React"}]]}],"\n",["$","blockquote","blockquote-0",{"children":["\n",["$","p","p-0",{"children":"Facebook的React Native是比基于WebView更先进的跨平台解决方案。实现了只编写一次JavaScript代码即可同时生成Android及iOS应用，并且同时拥有原生控件的性能。此篇文章我将从React Native Android端源码中探究它到底是如何做到的。以及实现的思路，架构的设计等。"}],"\n"]}],"\n","<!--more-->","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b"]}]}]]}],"$L3c","$L3d","$L3e"]}]
45:I[49558,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js","/_next/static/chunks/7f3c6470804733fc.js","/_next/static/chunks/1004c0a689e16f66.js"],"AdSenseCard"]
46:I[9725,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js","/_next/static/chunks/7f3c6470804733fc.js","/_next/static/chunks/1004c0a689e16f66.js"],"default"]
47:I[89864,["/_next/static/chunks/b9ccaea0d93f976a.js","/_next/static/chunks/75fe57ca492bcc5c.js","/_next/static/chunks/7f3c6470804733fc.js","/_next/static/chunks/1004c0a689e16f66.js"],"default"]
1f:["$","h2","h2-0",{"children":"核心类ReactActivity"}]
20:["$","p","p-0",{"children":["使用",["$","code","code-0",{"children":"react-native-cli"}],"生成工程文件，打开工程目录，发现有一个入口Activity：",["$","code","code-1",{"children":"MainActivity"}],"继承自",["$","code","code-2",{"children":"ReactActivity"}],"抽象类。这个",["$","code","code-3",{"children":"ReactActivity"}],"是React Native项目的唯一一个Activity，可以猜想其采用了单Activity的架构。回想Unity,LibGDX这样的游戏引擎，也是采用了这样的模式。"]}]
3f:T1a51,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">/**</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> * Base Activity for React Native applications.</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> */</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> abstract</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> class</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994"> ReactActivity</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> Activity</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">    implements</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> DefaultHardwareBackBtnHandler</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> PermissionAwareActivity</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> final</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ReactActivityDelegate</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> mDelegate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  protected</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> ReactActivity</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    mDelegate </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> createReactActivityDelegate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">Override</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  protected</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> onCreate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">Bundle </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">savedInstanceState</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#A65E2B, #C99076);--shiki-light:#A65E2B;--shiki-dark:#C99076">    super</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">onCreate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">savedInstanceState</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">    mDelegate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">onCreate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">savedInstanceState</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">...</span></span>
<span class="line"></span></code></pre>21:["$","div","pre-0",{"dangerouslySetInnerHTML":{"__html":"$3f"}}]
22:["$","p","p-1",{"children":["可以发现在Android框架创建",["$","code","code-0",{"children":"ReactActivity"}],"实例的同时会创建一个",["$","code","code-1",{"children":"ReactActivityDelegate"}],"对象。"]}]
23:["$","p","p-2",{"children":["然后",["$","code","code-0",{"children":"ReactActivity"}],"将Activity的生命周期方法和一些回调方法注入到这个",["$","code","code-1",{"children":"ReactActivityDelegate"}],"对象中。"]}]
24:["$","p","p-3",{"children":["看看这个",["$","code","code-0",{"children":"ReactActivityDelegate"}],"都在干啥。"]}]
25:["$","h2","h2-1",{"children":"核心类ReactActivityDelegate"}]
40:T2ea8,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">/**</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> * Delegate class for {@link ReactActivity} and {@link ReactFragmentActivity}. You can subclass this</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> * to provide custom implementations for e.g. {</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">@link</span><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> #</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">getReactNativeHost()</span><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">}, if your Application</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> * class doesn't implement {@link ReactApplication}.</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> */</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> class</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994"> ReactActivityDelegate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">Nullable</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ReactRootView</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> mReactRootView</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  protected</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> onCreate</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">Bundle </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">savedInstanceState</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mMainComponentName </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> null</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">      loadApp</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mMainComponentName</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">    }</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    mDoubleTapReloadRecognizer </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> new</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> DoubleTapReloadRecognizer</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  protected</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> loadApp</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">appKey</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mReactRootView </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> null</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">      throw</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> new</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> IllegalStateException</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#B5695977, #C98A7D77);--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">Cannot loadApp while app is already running.</span><span style="color:light-dark(#B5695977, #C98A7D77);--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">    }</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    mReactRootView </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> createRootView</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">    mReactRootView</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">startReactApplication</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">      getReactNativeHost</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">().</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">getReactInstanceManager</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(),</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      appKey</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">      getLaunchOptions</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">());</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">    getPlainActivity</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">().</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">setContentView</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mReactRootView</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  ...</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>26:["$","div","pre-1",{"dangerouslySetInnerHTML":{"__html":"$40"}}]
27:["$","p","p-4",{"children":[["$","code","code-0",{"children":"ReactActivityDelegate"}],"在",["$","code","code-1",{"children":"OnCreate"}],"方法中调用",["$","code","code-2",{"children":"loadApp"}],"方法，然后创建了一个",["$","code","code-3",{"children":"ReactRootView"}],",并调用了",["$","code","code-4",{"children":"ReactRootView"}],"的",["$","code","code-5",{"children":"startReactApplication"}],"方法，最后将这个",["$","code","code-6",{"children":"ReactRootView"}],"作为Activity的根View显示。"]}]
28:["$","p","p-5",{"children":["继续看这个",["$","code","code-0",{"children":"ReactRootView"}],"。"]}]
29:["$","h2","h2-2",{"children":"核心类ReactRootView"}]
41:T1f0d,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> class</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994"> ReactRootView</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> SizeMonitoringFrameLayout</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">    implements</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> RootView</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> MeasureSpecProvider</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  /**</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">   * Schedule rendering of the react component rendered by the JS application from the given JS</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">   * module (@{param moduleName}) using provided {</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">@param</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> reactInstanceManager}</span><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> to attach to the</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">   * JS context of that manager. Extra parameter {</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">@param</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> launchOptions}</span><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> can be used to pass initial</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">   * properties for the react component.</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">   */</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> startReactApplication</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      ReactInstanceManager </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">reactInstanceManager</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">moduleName</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">Nullable</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> Bundle </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">initialProperties</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      </span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">      if</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">mReactInstanceManager</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">hasStartedCreatingInitialContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">())</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">        mReactInstanceManager</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">createReactContextInBackground</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      }</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      </span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>2a:["$","div","pre-2",{"dangerouslySetInnerHTML":{"__html":"$41"}}]
2b:["$","p","p-6",{"children":["这个",["$","code","code-0",{"children":"startReactApplication()"}],"方法，最终调用了",["$","code","code-1",{"children":"ReactInstanceManager"}],"对象的",["$","code","code-2",{"children":"createReactContextInBackground()"}],"方法。"]}]
2c:["$","p","p-7",{"children":["继续追这个",["$","code","code-0",{"children":"ReactInstanceManager"}],"。"]}]
2d:["$","h2","h2-3",{"children":"核心类ReactInstanceManager"}]
42:T880e,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">@</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">ThreadSafe</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> class</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994"> ReactInstanceManager</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">ThreadConfined</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">UI</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> createReactContextInBackground</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">    recreateReactContextInBackgroundInner</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  </span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">ThreadConfined</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">UI</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> recreateReactContextInBackground</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">    recreateReactContextInBackgroundInner</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">ThreadConfined</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">UI</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> recreateReactContextInBackgroundInner</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">    recreateReactContextInBackgroundFromBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">ThreadConfined</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">UI</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> recreateReactContextInBackgroundFromBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">    recreateReactContextInBackground</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mJavaScriptExecutorFactory</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> mBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">ThreadConfined</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">UI</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> recreateReactContextInBackground</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    JavaScriptExecutorFactory </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">jsExecutorFactory</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    JSBundleLoader </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">jsBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">      runCreateReactContextOnNewThread</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">initParams</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">ThreadConfined</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">UI</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> runCreateReactContextOnNewThread</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">final</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ReactContextInitParams </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">initParams</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    mCreateReactContextThread </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        new</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> Thread</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">            new</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> Runnable</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">              @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">Override</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">              public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> run</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">                ···</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">                </span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">                  final</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ReactApplicationContext</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> reactApplicationContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">                      createReactContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">                          initParams</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">getJsExecutorFactory</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">().</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">create</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(),</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">                          initParams</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">getJsBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">                 ···</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">                  Runnable</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> setupReactContextRunnable</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">                      new</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> Runnable</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">                        @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">Override</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">                        public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> run</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">                          try</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">                            setupReactContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">reactApplicationContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">                          }</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> catch</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">Exception </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">e</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">                            mDevSupportManager</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">handleException</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">e</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">                          }</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">                        }</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">                      };</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">                  reactApplicationContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">runOnNativeModulesQueueThread</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">setupReactContextRunnable</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">                 ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">              }</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">            });</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">    mCreateReactContextThread</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">start</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  /**</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">   * </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">@return</span><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> instance of {@link ReactContext} configured a {@link CatalystInstance} set</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">   */</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ReactApplicationContext </span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">createReactContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      JavaScriptExecutor </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">jsExecutor</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      JSBundleLoader </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">jsBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">    final</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ReactApplicationContext</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> reactContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> new</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> ReactApplicationContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mApplicationContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    CatalystInstanceImpl</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">Builder</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> catalystInstanceBuilder</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> new</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> CatalystInstanceImpl</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">Builder</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      .</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">setReactQueueConfigurationSpec</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">ReactQueueConfigurationSpec</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">createDefault</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">())</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      .</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">setJSExecutor</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">jsExecutor</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      .</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">setRegistry</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">nativeModuleRegistry</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      .</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">setJSBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">jsBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      .</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">setNativeModuleCallExceptionHandler</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">exceptionHandler</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      catalystInstance </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> catalystInstanceBuilder</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">build</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    </span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">    catalystInstance</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">runJSBundle</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">    reactContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">initializeWithInstance</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">catalystInstance</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> reactContext</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>2e:["$","div","pre-3",{"dangerouslySetInnerHTML":{"__html":"$42"}}]
2f:["$","p","p-8",{"children":["这个",["$","code","code-0",{"children":"ReactInstanceManager"}],"有点长，通过一系列方法调用，最后通过",["$","code","code-1",{"children":"createReactContext()"}],"方法创建了",["$","code","code-2",{"children":"ReactApplicationContext"}],"的实例，并创建了",["$","code","code-3",{"children":"CatalystInstance"}],"用于初始化",["$","code","code-4",{"children":"reactContext"}],"。"]}]
30:["$","p","p-9",{"children":["在初始化",["$","code","code-0",{"children":"reactContext"}],"之前又调用了",["$","code","code-1",{"children":"catalystInstance.runJSBundle();"}],"，猜想这里是调用JS代码的入口，这里的",["$","code","code-2",{"children":"CatalystInstance"}],"是个接口，我们要查看",["$","code","code-3",{"children":"CatalystInstanceImpl"}],"来看看具体实现。"]}]
31:["$","h2","h2-4",{"children":"核心类CatalystInstanceImpl"}]
43:T53ae,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">/**</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> * This provides an implementation of the public CatalystInstance instance.  It is public because</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> * it is built by XReactInstanceManager which is in a different package.</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> */</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">@</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">DoNotStrip</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> class</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994"> CatalystInstanceImpl</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> implements</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> CatalystInstance</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  </span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> static</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> class</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994"> PendingJSCall</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">    void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> call</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">CatalystInstanceImpl </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">catalystInstance</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      NativeArray</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> arguments</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> mArguments </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> null</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> ?</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> mArguments </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">:</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> new</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> WritableNativeArray</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">      catalystInstance</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">jniCallJSFunction</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mModule</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> mMethod</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> arguments</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> native</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> jniSetSourceURL</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">sourceURL</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> native</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> jniRegisterSegment</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">int</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> segmentId</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">path</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> native</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> jniLoadScriptFromAssets</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">AssetManager </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">assetManager</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">assetURL</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> boolean</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> loadSynchronously</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> native</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> jniLoadScriptFromFile</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">fileName</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">sourceURL</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> boolean</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> loadSynchronously</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  @</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">Override</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  public</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> runJSBundle</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">    static</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">      ReactBridge</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">staticInit</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">    }</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">    mJSBundleLoader</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">loadScript</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">CatalystInstanceImpl</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">this</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">    synchronized</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">mJSCallsPendingInitLock</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">      // Loading the bundle is queued on the JS thread, but may not have</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">      // run yet.  It's safe to set this here, though, since any work it</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">      // gates will be queued on the JS thread behind the load.</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      mAcceptCalls </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> true</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">      for</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">PendingJSCall</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A"> function</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> :</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> mJSCallsPendingInit</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">        function</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">call</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#A65E2B, #C99076);--shiki-light:#A65E2B;--shiki-dark:#C99076">this</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">      }</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">      mJSCallsPendingInit</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">clear</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">();</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">      mJSBundleHasLoaded </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> true</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">  private</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> native</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> jniCallJSFunction</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">module</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    String </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">method</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    NativeArray </span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">arguments</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  ···</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>32:["$","div","pre-4",{"dangerouslySetInnerHTML":{"__html":"$43"}}]
33:["$","p","p-10",{"children":["这里通过",["$","code","code-0",{"children":"mJSBundleLoader.loadScript()"}],"去加载js，然后把js函数构建为",["$","code","code-1",{"children":"PendingJSCall"}],"放到一个列表里逐个执行，",["$","code","code-2",{"children":"PendingJSCall"}],"的",["$","code","code-3",{"children":"call()"}],"方法最终调用了C++层的",["$","code","code-4",{"children":"jniCallJSFunction()"}],"函数。"]}]
34:["$","p","p-11",{"children":["文件开头使用静态代码块",["$","code","code-0",{"children":"ReactBridge.staticInit()"}],"装载了名为",["$","code","code-1",{"children":"reactnativejni"}],"的so文件。"]}]
35:["$","p","p-12",{"children":"至此java层源码就追完了，我们接着看c++层源码"}]
36:["$","h2","h2-5",{"children":"C++层"}]
44:T5494,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">namespace facebook </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">{</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">namespace react </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> CatalystInstanceImpl::initializeBridge</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    jni::alias_ref</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">ReactCallback::javaobject</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> callback</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    // This executor is actually a factory holder.</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    JavaScriptExecutorHolder</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">*</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> jseh</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    jni::alias_ref</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">JavaMessageQueueThread::javaobject</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> jsQueue</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    jni::alias_ref</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">JavaMessageQueueThread::javaobject</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> nativeModulesQueue</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    jni::alias_ref</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">jni::JCollection</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">JavaModuleWrapper::javaobject</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">::javaobject</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> javaModules</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    jni::alias_ref</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">jni::JCollection</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">ModuleHolder::javaobject</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">::javaobject</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> cxxModules</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // TODO mhorowitz: how to assert here?</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // Assertions.assertCondition(mBridge == null, "initializeBridge should be called once");</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  moduleMessageQueue_ </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> std::make_shared</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">JMessageQueueThread</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">nativeModulesQueue</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // This used to be:</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  //</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // Java CatalystInstanceImpl -> C++ CatalystInstanceImpl -> Bridge -> Bridge::Callback</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // --weak--> ReactCallback -> Java CatalystInstanceImpl</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  //</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // Now the weak ref is a global ref.  So breaking the loop depends on</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // CatalystInstanceImpl#destroy() calling mHybridData.resetNative(), which</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // should cause all the C++ pointers to be cleaned up (except C++</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // CatalystInstanceImpl might be kept alive for a short time by running</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // callbacks). This also means that all native calls need to be pre-checked</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // to avoid NPE.</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // See the comment in callJSFunction.  Once js calls switch to strings, we</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // don't need jsModuleDescriptions any more, all the way up and down the</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // stack.</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">  moduleRegistry_ </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> std::make_shared</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">ModuleRegistry</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">    buildNativeModuleList</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">       std::weak_ptr</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">Instance</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">instance_</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">),</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">       javaModules</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">       cxxModules</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">       moduleMessageQueue_</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">  instance_</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">-></span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">initializeBridge</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    folly::make_unique</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">JInstanceCallback</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    callback</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    moduleMessageQueue_</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">),</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">    jseh</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">-></span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">getExecutorFactory</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(),</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    folly::make_unique</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">JMessageQueueThread</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">jsQueue</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">),</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    moduleRegistry_</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">void</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> CatalystInstanceImpl::jniCallJSFunction</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">std::string module</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> std::string method</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> NativeArray</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">*</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> arguments</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">)</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // We want to share the C++ code, and on iOS, modules pass module/method</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // names as strings all the way through to JS, and there's no way to do</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // string -> id mapping on the objc side.  So on Android, we convert the</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // number to a string, here which gets passed as-is to JS.  There, they they</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // used as ids if isFinite(), which handles this case, and looked up as</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // strings otherwise.  Eventually, we'll probably want to modify the stack</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  // from the JS proxy through here to use strings, too.</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">  instance_</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">-></span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">callJSFunction</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">std::move</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">module</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">),</span></span>
<span class="line"><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">                            std::move</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">method</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">),</span></span>
<span class="line"><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">                            arguments</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">-></span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">consume</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">());</span></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">···</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">}}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>37:["$","div","pre-5",{"dangerouslySetInnerHTML":{"__html":"$44"}}]
38:["$","p","p-13",{"children":["在这个",["$","code","code-0",{"children":"CatalystInstanceImpl.cpp"}],"中可以发现c++对于js的调用。以及非常棒的两段注释。"]}]
39:["$","p","p-14",{"children":"React Navtive 通过C++层去解释执行JS，从而达到一个比较好的性能。"}]
3a:["$","h2","h2-6",{"children":"总结"}]
3b:["$","p","p-15",{"children":"通过此文算是搞明白了，Android系统是怎么样去执行JavaScript代码的。\n但React Native又是如何将JS中的组件渲染成Android原生组件的仍然是个疑问。\n以后再研究吧..."}]
3c:["$","$L45",null,{}]
3d:["$","$L46",null,{}]
3e:["$","$L47",null,{"postId":"react-native"}]
1b:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
17:null
48:I[29406,["/_next/static/chunks/d12f64cde7c47586.js","/_next/static/chunks/2cc7ed3dfa1b294e.js"],"IconMark"]
19:{"metadata":[["$","title","0",{"children":"React Native源码解析（Android篇） | 王郁的小站"}],["$","meta","1",{"name":"description","content":"\n![React](/images/20180213_react.png)\n\n> Facebook的React Native是比基于WebView更先进的跨平台解决方案。实现了只编写一次JavaScript代码即可同时生成Android及iOS应用，并且同时拥有原生控件的性能。此篇文章我将从React Native Android端源码中探究它到底是如何做到的。以及实现的思路，架构的设计等。\n\n\n"}],["$","meta","2",{"name":"generator","content":"Next.js"}],["$","meta","3",{"name":"keywords","content":"Android,React Native,React,iOS"}],["$","meta","4",{"name":"creator","content":"王郁"}],["$","link","5",{"rel":"icon","href":"/favicon.ico?favicon.fe33cc56.ico","sizes":"48x48","type":"image/x-icon"}],["$","link","6",{"rel":"icon","href":"/icon.svg?icon.7d834061.svg","sizes":"any","type":"image/svg+xml"}],["$","$L48","7",{}]],"error":null,"digest":"$undefined"}
1e:"$19:metadata"
