1:"$Sreact.fragment"
2:I[58522,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],""]
1c:I[49558,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],"AdSenseCard"]
1d:I[9725,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],"default"]
1e:I[89864,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],"default"]
1f:I[71933,["/_next/static/chunks/be77d35d8dddc77a.js","/_next/static/chunks/0a126d9629c9d34c.js"],"OutletBoundary"]
20:"$Sreact.suspense"
:HL["https://www.zhengdexing.org/2020/10/20/HTTP%E5%8D%8F%E8%AE%AE-HTTP3/6301972-9482e8b53c342058.png","image"]
0:{"buildId":"wycode_has_super_power","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"container mx-auto w-full p-4","children":[["$","article",null,{"className":"card shadow bg-base-100 p-4 mb-4","children":[["$","h1",null,{"className":"text-2xl text-slate-800 dark:text-slate-200 font-extrabold text-center","children":"升级到HTTP3"}],["$","div",null,{"className":"flex justify-between text-sm mb-4 flex-wrap gap-2","children":[["$","span",null,{"className":"flex items-center","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","className":"inline mr-1 h-5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}]]}],"2022-09-29"]}],["$","$L2",null,{"href":"/blog/category/frontend","className":"flex items-center px-3 py-1 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-sm rounded-full","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","className":"inline mr-1 h-4 mb-0.5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}]]}],"Frontend"]}]]}],["$","div",null,{"className":"flex items-center gap-2 mb-4","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","className":"inline h-5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}],["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M6 6h.008v.008H6V6Z"}]]}],["$","div",null,{"className":"flex flex-wrap gap-1","children":[["$","$L2","HTTP",{"href":"/blog/tag/http","className":"px-2 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-sm rounded-full","children":"HTTP"}],["$","$L2","NGINX",{"href":"/blog/tag/nginx","className":"px-2 bg-yellow-50 hover:bg-yellow-100 dark:bg-yellow-900/30 dark:hover:bg-yellow-900/50 text-sm rounded-full","children":"NGINX"}]]}]]}],["$","div",null,{"className":"mt-4","children":["$","div",null,{"className":"prose max-w-full","children":[["$","figure","img-0",{"className":"flex flex-col items-center","children":[["$","img",null,{"src":"https://www.zhengdexing.org/2020/10/20/HTTP%E5%8D%8F%E8%AE%AE-HTTP3/6301972-9482e8b53c342058.png","alt":"http3","node":{"type":"element","tagName":"img","properties":{"src":"https://www.zhengdexing.org/2020/10/20/HTTP%E5%8D%8F%E8%AE%AE-HTTP3/6301972-9482e8b53c342058.png","alt":"http3"},"children":[],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":107,"offset":107}}},"className":"mx-auto max-h-64 max-w-72"}],["$","figcaption",null,{"className":"text-sm text-gray-500 dark:text-gray-400 mt-1","children":"http3"}]]}],"\n",["$","p","p-0",{"children":["基于 UDP 的 HTTP/3 协议规范",["$","a","a-0",{"href":"https://datatracker.ietf.org/doc/html/rfc9114","children":"RFC 9114"}],"于 2022 年 6 月发表。而 HTTP/2 协议规范",["$","a","a-1",{"href":"https://httpwg.org/specs/rfc7540.html","children":"RFC 7540"}],"早在 2015 年 5 月发表。但是仍然有很多网站在使用更加古老的 HTTP1.1。"]}],"\n",["$","p","p-1",{"children":["HTTP/2 通过多路复用（multiplexing）和头部压缩，能够有效降低延迟。同时还提供了不同于","$L3","协议的服务端推送的新方法。"]}],"\n","$L4","\n","$L5","\n","<!--more-->","\n","$L6","\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13"]}]}]]}],"$L14","$L15","$L16"]}],["$L17","$L18"],"$L19"]}],"loading":null,"isPartial":false}
3:["$","code","code-0",{"children":"WebScoket"}]
4:["$","p","p-2",{"children":"HTTP3 则使用基于 UDP 的 QUIC 协议，从根本上解决头部阻塞的问题，特别适用于移动网络不稳定情况下的网络效率改善。"}]
5:["$","p","p-3",{"children":"本文介绍 HTTP2，HTTP3 协议的新特性，以及通过 NGINX 升级到 HTTP2 和 HTTP3 的方法。"}]
6:["$","h2","h2-0",{"children":"回顾 HTTP/1.0 和 HTTP/1.1"}]
7:["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":"HTTP/1.0 每发送一个请求，就要建立一个新的 TCP 连接。"}],"\n",["$","li","li-1",{"children":"HTTP/1.1 加入了请求流水线（request pipelining），和持久连接。但多数情况下仍然会对不同的请求建立多个连接。由于 TCP 的特性，阻塞控制无法在多个连接之间共享，且浏览器限制了同服务器的总连接数。所以网络效率仍然较低。"}],"\n",["$","li","li-2",{"children":"此外 HTTP/1.1 和 1.0 都使用明文，用空格和回车进行字段分割，这导致了解析的复杂性和对不同变体的容忍度提升。"}],"\n"]}]
8:["$","h2","h2-1",{"children":"HTTP2"}]
9:["$","p","p-4",{"children":"HTTP/2 引入了二进制帧和多路复用来改善延迟，但它没有修改传输层（TCP），由于 TCP 严格按照顺序发送数据包，当数据包发生丢失时，TCP 协议会重发数据包，所以在丢包率较高的情况下多路复用的机制反而会变慢。"}]
a:["$","h2","h2-2",{"children":"HTTP3"}]
b:["$","p","p-5",{"children":"HTTP/3 使用基于 UDP 的 QUIC 协议，拥有 HTTP2 所有的优良特性，并且由于 UDP 天生无需握手，且在网络环境发生变化时无需重新建立连接，例如切换移动网络到 WIFI。"}]
c:["$","h2","h2-3",{"children":"升级到 HTTP2"}]
d:["$","p","p-6",{"children":["NGINX 默认使用 HTTP/1.1, 我们只需简单的添加",["$","code","code-0",{"children":"http2"}],"到",["$","code","code-1",{"children":"listen"}],"指令即可无痛升级到 HTTP2："]}]
1a:T570,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">...</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">server</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    listen </span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91">443</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ssl http2</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ...</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">}</span></span>
<span class="line"></span></code></pre>e:["$","div","pre-0",{"dangerouslySetInnerHTML":{"__html":"$1a"}}]
f:["$","h2","h2-4",{"children":"升级到 HTTP3"}]
10:["$","p","p-7",{"children":["截止到今天（2022 年 10 月 1 日），NGINX 对 HTTP3 的支持还在开发中（nginx-quic 分支），官方还没有发布基于此分支的 docker 镜像，这里我使用民间编译的镜像",["$","code","code-0",{"children":"dasskelett/nginx-quic"}],"。"]}]
11:["$","p","p-8",{"children":"修改配置:"}]
1b:Tcdd,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">...</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">server</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    listen </span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91">443</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ssl http2</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    listen </span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91">443</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> http3 reuseport</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ...</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    ssl_early_data on</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    add_header </span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">Alt-Svc </span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">'h3=":443"; ma=86400'</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    add_header </span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">QUIC-Status </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">$</span><span style="color:light-dark(#B07D48, #BD976A);--shiki-light:#B07D48;--shiki-dark:#BD976A">http3</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    ...</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">}</span></span>
<span class="line"></span></code></pre>12:["$","div","pre-1",{"dangerouslySetInnerHTML":{"__html":"$1b"}}]
13:["$","p","p-9",{"children":"至此本站已全面支持 HTTP3。"}]
14:["$","$L1c",null,{}]
15:["$","$L1d",null,{}]
16:["$","$L1e",null,{"postId":"http3"}]
17:["$","script","script-0",{"src":"/_next/static/chunks/473a1be2867482bb.js","async":true}]
18:["$","script","script-1",{"src":"/_next/static/chunks/a5d1ba47f41dfe06.js","async":true}]
19:["$","$L1f",null,{"children":["$","$20",null,{"name":"Next.MetadataOutlet","children":"$@21"}]}]
21:null
