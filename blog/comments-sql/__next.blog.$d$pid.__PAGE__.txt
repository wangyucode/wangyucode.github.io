1:"$Sreact.fragment"
2:I[58522,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],""]
1a:I[49558,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],"AdSenseCard"]
1b:I[9725,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],"default"]
1c:I[89864,["/_next/static/chunks/1e02b7c5799ac6a1.js","/_next/static/chunks/3b6828ba17d8ab80.js","/_next/static/chunks/473a1be2867482bb.js","/_next/static/chunks/a5d1ba47f41dfe06.js"],"default"]
1d:I[71933,["/_next/static/chunks/be77d35d8dddc77a.js","/_next/static/chunks/0a126d9629c9d34c.js"],"OutletBoundary"]
1e:"$Sreact.suspense"
:HL["https://image.woshipm.com/wp-files/2018/04/QFTkYSkExyHKCzhTTl7V.jpg","image"]
0:{"buildId":"wycode_has_super_power","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"container mx-auto w-full p-4","children":[["$","article",null,{"className":"card shadow bg-base-100 p-4 mb-4","children":[["$","h1",null,{"className":"text-2xl text-slate-800 dark:text-slate-200 font-extrabold text-center","children":"从0开始开发一个评论系统"}],["$","div",null,{"className":"flex justify-between text-sm mb-4 flex-wrap gap-2","children":[["$","span",null,{"className":"flex items-center","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","className":"inline mr-1 h-5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}]]}],"2019-05-21"]}],["$","$L2",null,{"href":"/blog/category/backend","className":"flex items-center px-3 py-1 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-sm rounded-full","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","className":"inline mr-1 h-4 mb-0.5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}]]}],"Backend"]}]]}],["$","div",null,{"className":"flex items-center gap-2 mb-4","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","aria-hidden":"true","data-slot":"icon","className":"inline h-5","children":[null,["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}],["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M6 6h.008v.008H6V6Z"}]]}],["$","div",null,{"className":"flex flex-wrap gap-1","children":[["$","$L2","Kotlin",{"href":"/blog/tag/kotlin","className":"px-2 bg-green-50 hover:bg-green-100 dark:bg-green-900/30 dark:hover:bg-green-900/50 text-sm rounded-full","children":"Kotlin"}],["$","$L2","SQL",{"href":"/blog/tag/sql","className":"px-2 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-sm rounded-full","children":"SQL"}],["$","$L2","Spring",{"href":"/blog/tag/spring","className":"px-2 bg-pink-50 hover:bg-pink-100 dark:bg-pink-900/30 dark:hover:bg-pink-900/50 text-sm rounded-full","children":"Spring"}],["$","$L2","JPA",{"href":"/blog/tag/jpa","className":"px-2 bg-pink-50 hover:bg-pink-100 dark:bg-pink-900/30 dark:hover:bg-pink-900/50 text-sm rounded-full","children":"JPA"}],["$","$L2","Hibernate",{"href":"/blog/tag/hibernate","className":"px-2 bg-purple-50 hover:bg-purple-100 dark:bg-purple-900/30 dark:hover:bg-purple-900/50 text-sm rounded-full","children":"Hibernate"}]]}]]}],["$","div",null,{"className":"mt-4","children":["$","div",null,{"className":"prose max-w-full","children":[["$","figure","img-0",{"className":"flex flex-col items-center","children":[["$","img",null,{"src":"https://image.woshipm.com/wp-files/2018/04/QFTkYSkExyHKCzhTTl7V.jpg","alt":"网易云音乐","node":{"type":"element","tagName":"img","properties":{"src":"https://image.woshipm.com/wp-files/2018/04/QFTkYSkExyHKCzhTTl7V.jpg","alt":"网易云音乐"},"children":[],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":78,"offset":78}}},"className":"mx-auto max-h-64 max-w-72"}],"$L3"]}],"\n","$L4","\n","$L5","\n","<!--more-->","\n","$L6","\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10"]}]}]]}],"$L11","$L12","$L13"]}],["$L14","$L15"],"$L16"]}],"loading":null,"isPartial":false}
3:["$","figcaption",null,{"className":"text-sm text-gray-500 dark:text-gray-400 mt-1","children":"网易云音乐"}]
4:["$","p","p-0",{"children":"畅言的广告有点过于流氓，所以准备开发一套评论系统，除了博客，还能用在其它APP中。"}]
5:["$","p","p-1",{"children":"基本需求类似网易云音乐的评论，可以对引用别人的评论回复，可以点赞。"}]
6:["$","h2","h2-0",{"children":"表结构"}]
7:["$","p","p-2",{"children":"为了保证表结构尽可能简单的同时又支持类似网易云一样功能，同时又保证可扩展性，采用单表设计，表结构（映射实体）如下。"}]
17:T3bae,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">@Entity</span></span>
<span class="line"><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">data</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> class</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994"> Comment</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">        @Id</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">        @GeneratedValue</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(generator </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "seq_comment"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">        @SequenceGenerator</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(name </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "seq_comment"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">, sequenceName </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "SEQ_COMMENT"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">, allocationSize </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">, initialValue </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> id: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Long</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">        @ApiModelProperty</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">value</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "主题id"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> topicId: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> ""</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">        @ManyToOne</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> app: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">CommentApp</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> CommentApp</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(),</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">        @Column</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(length </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 1023</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> content: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">        @ApiModelProperty</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">value</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "评论类型，0.文字评论，1.点赞，2.图片评论"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> type: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Int</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> fromUserId: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> ""</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> fromUserName: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> fromUserIcon: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toUserId: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toUserName: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toUserIcon: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toContent: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> createTime: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Date</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> Date</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(),</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        var</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> likeCount: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Int</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"></span></code></pre>8:["$","div","pre-0",{"dangerouslySetInnerHTML":{"__html":"$17"}}]
9:["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":["为了能够在多个app中使用，所以增加了一个",["$","code","code-0",{"children":"CommentApp"}],"实体，里面包含一个name和accessKey，评论和app是多对一关系。"]}],"\n",["$","li","li-1",{"children":[["$","code","code-0",{"children":"type"}],"字段可以用来扩展为直接对文章点赞，以及图片的评论（",["$","code","code-1",{"children":"content"}],"为图片地址）。"]}],"\n",["$","li","li-2",{"children":"为了保持评论系统的独立，所以用户信息应该由使用评论的app提供，比如使用第三方登录。所以并不需要用户表。"}],"\n",["$","li","li-3",{"children":"这里冗余引用的评论信息，就不需要考虑嵌套查询，以及实体嵌套，循环引用的问题。只保留一层引用，当然也就只支持一对一的回复了。"}],"\n",["$","li","li-4",{"children":["页面展示上其实并不需要",["$","code","code-0",{"children":"UserId"}],"，这里是考虑提高数据的可维护性。"]}],"\n"]}]
a:["$","h2","h2-1",{"children":"接口"}]
b:["$","h3","h3-0",{"children":"1.新增评论或点赞"}]
18:T9101,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">@ApiOperation</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">value</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "新增评论及点赞"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">@RequestMapping</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(path </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> [</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"/newComment"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">], method </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> [RequestMethod.POST])</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">fun</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> newComment</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">@RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> accessKey: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> appName: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @ApiParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"评论类型，0.文字评论，1.点赞，2.图片评论"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">, defaultValue </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "0"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,example </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "0"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,allowableValues </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "0,1,2"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(required </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> false</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">, defaultValue </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "0"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) type: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Int</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> topicId: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(required </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> false</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) content: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">?,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> fromUserId: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(required </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> false</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) fromUserName: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">?,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(required </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> false</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) fromUserIcon: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">?,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">               @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(required </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375"> false</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) toCommentId: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Long</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">?</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">): </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">JsonResult</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">&#x3C;</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Comment</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">> {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (type </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> ||</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> type </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 2</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"参数错误"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    var</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> contentText </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> content</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    //文字及图片评论内容限制</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (type </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">==</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> ||</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> type </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">==</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 2</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (StringUtils.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">isEmpty</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(contentText)) </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"内容不能为空"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (contentText</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!!</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">.length </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 1023</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"内容不能超过1000个字"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    }</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> app </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> commentAppRepository.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">findByNameAndAccessKey</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(appName, accessKey)</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            ?: </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"app不存在，或key错误"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    //图片评论上传至OSS</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (type </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">==</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 2</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> file </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> storageService.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">loadTemp</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(contentText).</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">toFile</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">()</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">file.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">exists</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">()) {</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">            return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"相片不存在"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">        }</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">        contentText </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> ossService.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">putFile</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(OssService.COMMENT_BUCKET_NAME, appName, file)</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">                ?: </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"评论失败，请重试"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    }</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    //处理回复</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    var</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toComment: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Comment</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">? </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (toCommentId </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!=</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676"> &#x26;&#x26;</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toCommentId </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">        toComment </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> commentRepository.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">findById</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(toCommentId).</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">orElse</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">null</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) ?: </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"被回复的评论不存在"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (toComment.topicId </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">!=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> topicId) </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"不能跨主题回复"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (toComment.type </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">==</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"不能对点赞回复"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">        //对评论点赞，直接对点赞数+1，不保存此条评论</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> (type </span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">==</span><span style="color:light-dark(#2F798A, #4C9A91);--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">) {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            toComment.likeCount</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">++</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">            return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">data</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(commentRepository.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">save</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(toComment))</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">        }</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    }</span></span>
<span class="line"><span style="color:light-dark(#A0ADA0, #758575DD);--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    //需要新增的comment</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    val</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> comment </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> Comment</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            topicId </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> topicId,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            app </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> app,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            content </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> contentText,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            type </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> type,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            fromUserId </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> fromUserId,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            fromUserName </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> fromUserName,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            fromUserIcon </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> fromUserIcon,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            toUserId </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toComment?.fromUserId,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            toUserName </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toComment?.fromUserName,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            toUserIcon </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toComment?.fromUserIcon,</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            toContent </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> toComment?.content)</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    log.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">info</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"$fromUserName 评论了 </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">app.name</span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> 的 $topicId"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">data</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(commentRepository.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">save</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(comment))</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">}</span></span>
<span class="line"></span></code></pre>c:["$","div","pre-1",{"dangerouslySetInnerHTML":{"__html":"$18"}}]
d:["$","h3","h3-1",{"children":"2.获取评论列表"}]
19:T18b7,<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:light-dark(#ffffff, #121212);--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;color:light-dark(#393a34, #dbd7caee);--shiki-light:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">@ApiOperation</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#AB5959, #CB7676);--shiki-light:#AB5959;--shiki-dark:#CB7676">value</span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666"> =</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D"> "获取评论列表"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">@RequestMapping</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(path </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> [</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"/getComments"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">], method </span><span style="color:light-dark(#999999, #666666);--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> [RequestMethod.GET])</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">fun</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665"> getComments</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">@RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> accessKey: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">                @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> appName: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">,</span></span>
<span class="line"><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">                @RequestParam</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> topicId: </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">String</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">): </span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">JsonResult</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">&#x3C;</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">List</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">&#x3C;</span><span style="color:light-dark(#2E8F82, #5DA994);--shiki-light:#2E8F82;--shiki-dark:#5DA994">Comment</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">>> {</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">    commentAppRepository.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">findByNameAndAccessKey</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(appName, accessKey)</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            ?: </span><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">error</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(</span><span style="color:light-dark(#B56959, #C98A7D);--shiki-light:#B56959;--shiki-dark:#C98A7D">"app不存在，或key错误"</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">)</span></span>
<span class="line"><span style="color:light-dark(#1E754F, #4D9375);--shiki-light:#1E754F;--shiki-dark:#4D9375">    return</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> JsonResult.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">data</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(commentRepository.</span><span style="color:light-dark(#59873A, #80A665);--shiki-light:#59873A;--shiki-dark:#80A665">findAllByApp_NameAndTopicIdAndDeleted</span><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">(appName, topicId))</span></span>
<span class="line"><span style="color:light-dark(#393A34, #DBD7CAEE);--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">}</span></span>
<span class="line"></span></code></pre>e:["$","div","pre-2",{"dangerouslySetInnerHTML":{"__html":"$19"}}]
f:["$","p","p-3",{"children":"最终效果即为目前页面下方的评论功能。"}]
10:["$","p","p-4",{"children":"以上，转载请注明出处!"}]
11:["$","$L1a",null,{}]
12:["$","$L1b",null,{}]
13:["$","$L1c",null,{"postId":"comments-sql"}]
14:["$","script","script-0",{"src":"/_next/static/chunks/473a1be2867482bb.js","async":true}]
15:["$","script","script-1",{"src":"/_next/static/chunks/a5d1ba47f41dfe06.js","async":true}]
16:["$","$L1d",null,{"children":["$","$1e",null,{"name":"Next.MetadataOutlet","children":"$@1f"}]}]
1f:null
